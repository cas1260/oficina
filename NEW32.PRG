***************************
* NEW32.PRG FOTE DE SENHA *
***************************
PRIVATE VSENHA
SAVE SCREEN TO VTELA_USU
DO WHILE .T.
	@ 15,35 CLEAR TO 18,70
	@ 15,35 TO 18,70 DOUBLE
	VNOME = SPACE(24)
	@ 16,37 SAY "Nome  " GET VNOME PICT "@!"
	@ 17,37 SAY "Senha "
	SET COLOR TO I/W
		@ 17,44 SAY SPACE(24)
	SET COLOR TO &VCOR
	READ
	IF LASTKEY()=27
		EXIT
	ENDIF
	DO SENHA_USU
	IF LASTKEY()=27
		EXIT
	ENDIF
	USE USUARIO 
	APPEND BLANK
		REPLACE NOME WITH VNOME
		REPLACE SENHA WITH VSENHA
		SAVE SCREEN TO MSG
			MSGBOX("Usuario Incluido!")
		RESTORE SCREEN FROM MSG
	CLOSE ALL
ENDDO
RESTORE SCREEN FROM VTELA_USU
RETURN
*******************
PROCEDURE SENHA_USU
*******************
VSENHA = ""
VCOR = SETCOLOR()
@ 17,44 SAY ""
DO WHILE .T.
	A = INKEY(0)
	IF LASTKEY()>31 .AND. LASTKEY()<128
		IF LEN(VSENHA)<24
			VSENHA = VSENHA + CHR(A)
		ENDIF
	ENDIF
	IF LASTKEY()=8 .OR. LASTKEY()=19
		VSENHA = LEFT(VSENHA,LEN(VSENHA)-1)
	ENDIF
	SET COLOR TO I/W
		@ 17,44 SAY SPACE(24)
		@ 17,44 SAY REPLICATE(CHR(4),LEN(VSENHA))
	SET COLOR TO &VCOR
*	@ 24,00 SAY VSENHA
	IF LASTKEY()=27 .OR. LASTKEY()=13
		EXIT 
	ENDIF
ENDDO
VSENHA = CRIPTA(VSENHA)