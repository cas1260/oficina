**************
FUNCTION SOBRA1
**************
PARAMETERS VCOLI,VLINI,VCOLF, VLINF,VCOR1,VCOR2
P=SETCOLOR() 
SET COLOR TO &VCOR1
@ VCOLI,VLINI CLEAR TO VCOLF,VLINF
@ VCOLI,VLINI TO VCOLF,VLINF DOUBLE
SET COLOR TO &VCOR2
@ VCOLF,VLINI+1 TO VCOLF,VLINF DOUBLE
@ VCOLI,VLINF TO VCOLF,VLINF DOUBLE
@ VCOLF,VLINF SAY CHR(217)
@ VCOLI,VLINF SAY CHR(187)
@ VCOLF,VLINI SAY CHR(200)
@ VCOLF,VLINF SAY CHR(188)

RETURN .T.
SET COLOR TO &P
PROCEDURE SP
IF LEN(TD)=1
	TD=TD+SPACE(9)
ELSEIF LEN(TD)=2
	TD=TD+SPACE(8)
ELSEIF LEN(TD)=3
	TD=TD+SPACE(7)
ELSEIF LEN(TD)=4
	TD=TD+SPACE(6)
ELSEIF LEN(TD)=5
	TD=TD+SPACE(5)
ELSEIF LEN(TD)=6
	TD=TD+SPACE(4)
ELSEIF LEN(TD)=7
	TD=TD+SPACE(3)
ELSEIF LEN(TD)=8
	TD=TD+SPACE(2)
ELSEIF LEN(TD)=9
	TD=TD+SPACE(1)
ENDIF
PROCEDURE SE
VSENHAP=SENHA
IF LEN(VSENHAP)=1
        VSENHAP=VSENHAP+SPACE(9)
ELSEIF LEN(VSENHAP)=2
        VSENHAP=VSENHAP+SPACE(8)
ELSEIF LEN(VSENHAP)=3
        VSENHAP=VSENHAP+SPACE(7)
ELSEIF LEN(VSENHAP)=4
        VSENHAP=VSENHAP+SPACE(6)
ELSEIF LEN(VSENHAP)=5
        VSENHAP=VSENHAP+SPACE(5)
ELSEIF LEN(VSENHAP)=6
        VSENHAP=VSENHAP+SPACE(4)
ELSEIF LEN(VSENHAP)=7
        VSENHAP=VSENHAP+SPACE(3)
ELSEIF LEN(VSENHAP)=8
        VSENHAP=VSENHAP+SPACE(2)
ELSEIF LEN(VSENHAP)=9
        VSENHAP=VSENHAP+SPACE(1)
ENDIF
VS=VSENHAP
**************
FUNCTION SOBRA
**************
PARAMETERS VCOLI,VLINI,VCOLF, VLINF,VCOR1,VCOR2
VB=SETCOLOR()
SET COLOR TO &VCOR1
@ VCOLI,VLINI CLEAR TO VCOLF,VLINF
@ VCOLI,VLINI TO VCOLF,VLINF 
SET COLOR TO &VCOR2
@ VCOLF,VLINI+1 TO VCOLF,VLINF
@ VCOLI,VLINF TO VCOLF,VLINF
@ VCOLF,VLINF SAY CHR(217)
@ VCOLI,VLINF SAY CHR(191)
*@ VCOLF,VLINI SAY CHR(192)
SET COLOR TO &VB
RETURN .T.
SET COLOR TO &VB
**************
PROCEDURE CALE
**************
SAVE SCREEN TO VTELACAL
P=SETCOLOR()
SET CURSO ON
DO WHILE LAST()#27	
	SOBRA(10,20,12,50,"W+/G","I/G")
	DATE=DATE()
	SET COLOR TO GR/G
	@ 11,21 SAY "Data "GET DATE
	READ
	IF LAST()#27
		@ 11,38 SAY DIASEM(DATE)
		INKEY(0)

	ENDIF
ENDDO
SET COLOR TO &P
RESTORE SCREEN FROM VTELACAL
RETURN
SET COLOR TO &P
*************
PROCEDURE CAL
*************
SAVE SCREEN TO VTELACAL
COLOR=SETCOLOR()
VCOR = SETCOLOR()
DO WHILE LAST()#27
	PRIVATE VCAL[10]

	@ 06,15 CLEAR TO 23,50 
	@ 06,15 TO 23,50 DOUBLE
	@ 07,16 TO 10,49
	DO NUMERO
	CL=SETCOLOR()
	SET COLOR TO I/W
	SET CURSO ON
	VCA1=0
	VCA2=0
	VV = ""
	VR=SPACE(1)
	SET COLOR TO &VCOR
	*@ 08,17 SAY SPACE(32)
	*@ 09,17 SAY SPACE(32)
	*@ 09,27 GET VCA1 PICT  "9999999999999999.99"
	*@ 09,48 GET VR VALID VR$"+-*/" 
	*P=VR
	
	*READ
	VT=SETCOLOR()
	T = 1
	DO WHILE .T.
		SET COLOR TO N/W
		@ 08,17 SAY SPACE(32)
		@ 09,17 SAY SPACE(32)
		@ 09,17 SAY VV
		A = INKEY()
		IF A>=42 .AND. A<=57
			VV = VV+CHR(A)
			IF A = 13
				IF T = 1
					VCA1 = VAL(VV)
					T = 2
				ELSE
					VCA2 = VAL(VV)
					EXIT
				ENDIF
			ENDIF
			IF A = 43 
				VRS = CHR(A)
				VCA1 = VAL(VV)
				T = 2
			   IF VR$"/*-+"
		     		ARIT	= VR
			      ARIT_DISP =IIF(ARIT="/","ö",IIF(ARIT="*","X",IIF(ARIT="+","+","-")))
					@ 08,38 SAY  ARIT_DISP 
	   		ENDIF		
			ENDIF
			IF A = 45
				VRS = CHR(A)
				VCA1 = VAL(VV)
				T = 2
			   IF VR$"/*-+"
		     		ARIT	= VR
			      ARIT_DISP =IIF(ARIT="/","ö",IIF(ARIT="*","X",IIF(ARIT="+","+","-")))
					@ 08,38 SAY  ARIT_DISP 
	   		ENDIF		
			ENDIF
			IF A = 42
				VRS = CHR(A)
				VCA1 = VAL(VV)
				T = 2
			   IF VR$"/*-+"
		     		ARIT	= VR
			      ARIT_DISP =IIF(ARIT="/","ö",IIF(ARIT="*","X",IIF(ARIT="+","+","-")))
					@ 08,38 SAY  ARIT_DISP 
	   		ENDIF		
			ENDIF
			IF A = 47
				VRS = CHR(A)
				VCA1 = VAL(VV)
				T = 2
			   IF VR$"/*-+"
		     		ARIT	= VR
			      ARIT_DISP =IIF(ARIT="/","ö",IIF(ARIT="*","X",IIF(ARIT="+","+","-")))
					@ 08,38 SAY  ARIT_DISP 
	   		ENDIF		
			ENDIF
		ENDIF
	IF A=27
		VV = LEFT(VV,LEN(VV)-1)
	ENDIF
ENDDO
@ 08,17 SAY SPACE(32)
@ 09,17 SAY SPACE(32)
@ 08,20 SAY VCA1 PICT "9999999.99"
@ 08,38 SAY VCA2 PICT "9999999.99"
@ 09,17 SAY "="

VT=.F.
IF VR="/"
VT=.T.
	TOTAL=VCA1/VCA2
	VR="ö"
ELSEIF VR="*"
VT=.T.
	TOTAL=VCA1*VCA2
	VR="X"
ELSEIF VR="+"
VT=.T.
	TOTAL=VCA1+VCA2
VR="+"
ELSEIF VR="-"
VT=.T.
VR="-"
	TOTAL=VCA1+VCA2		
ENDIF
IF VR=" "
VT=.T.
	TOTAL="***********"
ENDIF
IF LAST()#27 
	@ 09,18 SAY TOTAL PICT "999999999999999999999999999999"
	@ 08,32 SAY VR
	INKEY(0)
ENDIF	
ENDDO
SET COLOR TO &COLOR
RESTORE SCREEN FROM VTELACAL
RETURN

PROCEDURE NUMERO
COR=SETCOLOR()
@ 11,17 TO 13,21
@ 12,19 SAY "1"
@ 11,25 TO 13,29
@ 12,27 SAY "2"
@ 11,33 TO 13,37
@ 12,35 SAY "3"
@ 14,17 TO 16,21
@ 15,19 SAY "4"
@ 14,25 TO 16,29
@ 15,27 SAY "5"
@ 14,33 TO 16,37
@ 15,35 SAY "6"
@ 17,17 TO 19,21
@ 18,19 SAY "7"
@ 17,25 TO 19,29
@ 18,27 SAY "8"
@ 17,33 TO 19,37
@ 18,35 SAY "9"
@ 20,17 TO 22,21
@ 21,19 SAY "-"
@ 20,25 TO 22,29
@ 21,27 SAY "0"
@ 20,33 TO 22,37
@ 21,35 SAY "+"
@ 11,41 TO 13,45
@ 12,43 SAY "ö"
@ 14,41 TO 16,45
@ 15,43 SAY "X"
@ 18,41 TO 22,45
@ 20,43 SAY "="
**************
FUNCTION SOBRAL
**************
PARAMETERS VCOLI,VLINI,VCOLF, VLINF,VCOR1,VCOR2
P=SETCOLOR() 
SET COLOR TO &VCOR1
*@ VCOLI,VLINI CLEAR TO VCOLF,VLINF
@ VCOLI,VLINI TO VCOLF,VLINF 
SET COLOR TO &VCOR2
@ VCOLF,VLINI+1 TO VCOLF,VLINF
@ VCOLI,VLINF TO VCOLF,VLINF
@ VCOLF,VLINF SAY CHR(217)
@ VCOLI,VLINF SAY CHR(191)
*@ VCOLF,VLINI SAY CHR(192)
SET COLOR TO &P
RETURN .T.
SET COLOR TO &P

*****************
 PROCEDURE INDEX 
*****************
SAVE SCREEN TO VTELAINDEX
	SET CURSO OFF
	@ 24,00 SAY SPACE(80)
	@ 24,00 SAY "A g u a r d e  "
	IF VINDEX = "T"
		USE CLIENTE INDEX CLIENTE1 INDEX CLIENTE2	INDEX CLIENTE3
		PACK
		USE PRODUTO INDEX PRODUTO1 INDEX PRODUTO2
		PACK
		USE VENDAS
		PACK
	ENDIF
	@ 24,14 SAY "  0%"
	IF VINDEX = "1" .OR. VINDEX = "T"
		@ 24,14 SAY "  5%"
		USE CLIENTE
		ERASE("CLIENTE1.NTX")
		@ 24,14 SAY " 20%"
		INDEX ON PLACA TO CLIENTE1
		@ 24,14 SAY " 25%"
		ERASE("CLIENTE2.NTX")
		INDEX ON NOME TO CLIENTE2
		@ 24,14 SAY " 40%"
		ERASE("CLIENTE3.NTX")
		INDEX ON EMP TO CLIENTE3
		@ 24,14 SAY " 45%"
	ENDIF
	IF VINDEX = "2" .OR. VINDEX = "T"
		USE PRODUTO
		@ 24,14 SAY " 50%"
		ERASE("PRODUTO1.NTX")
		INDEX ON CODP TO PRODUTO1
		@ 24,14 SAY " 60%"
		ERASE("PRODUTO2.NTX")
		INDEX ON DESCRICAO TO PRODUTO2
		@ 24,14 SAY " 70%"
	ENDIF
	IF VINDEX = "3" .OR. VINDEX = "T"
		USE VENDAS
		ERASE("VENDAS.NTX")
		@ 24,14 SAY "  80%"
		INDEX ON DATA TO VENDAS
	ENDIF
	IF VINDEX = "4" .OR. VINDEX = "T"

		@ 24,14 SAY " 100%"
	ENDIF
	@ 24,14 SAY "  100%"
	INKEY(0.8)
	SET CURSO ON
	CLOSE ALL
RESTORE SCREEN FROM VTELAINDEX
RETURN
*********************	
FUNCTION CLIENTE
********************
	PARAMETERS VCHAVE
	USE CLIENTE INDEX CLIENTE1 INDEX CLIENTE2

	PRIVATE VCOLOR,VTELA,VCAMPOS[4],VCABEC[4],VLIN,VCOL,VRET

	VLIN = ROW()
	VCOL = COL()
	
   SAVE SCREEN TO VTELA12
	VCOLOR = SETCOLOR()

	
	VCABEC[1] = "EMPRESA"
	VCABEC[2] = "PLACA"
	VCABEC[3] = "NOME"
*	VCABEC[4] = "DEPENDENTE 2"	
	
	VCAMPOS[1] = "EMP"
	VCAMPOS[2] = "PLACA"
	VCAMPOS[3] = "NOME"
*	VCAMPOS[4] = "DEP2"	

	SEEK VCODIGO
	
	IF .NOT. EOF()
		VCODIGO = PLACA
	ELSE
		VCODIGO = ""
	ENDIF
	
	SET ORDER TO 2
	
	IF EMPTY(VCODIGO)
		GOTO TOP
	ELSE
		SEEK VCODIGO
	ENDIF
		@ 08,24 CLEAR TO 21,76
	@ 08,24 TO 21,76

	CENTRA(09,25,76,"Procura de Cliente")
	DBEDIT(10,25,20,75,VCAMPOS,"ACHALETRA",0,VCABEC)
	IF LASTKEY() # 27
		VCODIGO = PLACA
		KEYBOARD CHR(13)		
	ELSE
		VRET = ""
		KEYBOARD CHR(13)
		VUPD = .T.
	ENDIF
	
	SET ORDER TO 1

	@ VLIN,VCOL
	SETCOLOR(VCOLOR)
        RESTORE SCREEN FROM VTELA12
       
	RETURN VCODIGO
*********************	
FUNCTION DELCLIENTE
********************
	PARAMETERS VCHAVE
	USE CLIENTE INDEX CLIENTE1 INDEX CLIENTE2

	PRIVATE VCOLOR,VTELA,VCAMPOS[4],VCABEC[4],VLIN,VCOL,VRET

	VLIN = ROW()
	VCOL = COL()
	
   SAVE SCREEN TO VTELA12
	VCOLOR = SETCOLOR()

	
	VCABEC[1] = "NOME"
	VCABEC[2] = "Placa"
*	VCABEC[3] = "DEPENDENTE 1"
*	VCABEC[4] = "DEPENDENTE 2"	
	
	VCAMPOS[1] = "NOME"
	VCAMPOS[2] = "PLACA"
*	VCAMPOS[3] = "DEP1" 
*	VCAMPOS[4] = "DEP2"	

	SEEK VCODIGO
	
	IF .NOT. EOF()
		VCODIGO = PLACA
	ELSE
		VCODIGO = ""
	ENDIF
	
	SET ORDER TO 2
	
	IF EMPTY(VCODIGO)
		GOTO TOP
	ELSE
		SEEK VCODIGO
	ENDIF
	@ 08,24 CLEAR TO 21,76
	@ 08,24 TO 21,76
	CENTRA(09,25,76,"Dele‡ao de Cliente")

	DBEDIT(10,25,20,75,VCAMPOS,"ACHALETRA",0,VCABEC)
			@ 16,40 CLEAR TO 19,65
			@ 16,40 TO 19,65
				CENTRA(17,40,65,"Confimar Dele‡ao")
				@ 18,45 PROMPT " SIM "
				@ 18,53 PROMPT " NAO "
				MENU TO VOP
					DO CASE 
					CASE VOP=0
					
					CASE VOP=1
						DELE

			ENDCASE
	IF LASTKEY() # 27
		VCODIGO = PLACA
		KEYBOARD CHR(13)		
	ELSE
		VRET = ""
		KEYBOARD CHR(13)
		VUPD = .T.
	ENDIF
	
	SET ORDER TO 1

	@ VLIN,VCOL
	SETCOLOR(VCOLOR)
        RESTORE SCREEN FROM VTELA12
       
	VCODIGO = "       "
	RETURN VCODIGO

*******************
FUNCTION PRODUTO
*******************
PARAMETERS VCHAVE

USE PRODUTO INDEX PRODUTO1 INDEX PRODUTO2

PRIVATE VCOLOR,VTELA,VCAMPOS[4],VCABEC[4],VLIN,VCOL,VRET

VLIN = ROW()
VCOL = COL()
	
SAVE SCREEN TO VTELA
VCOLOR = SETCOLOR()




VCABEC[1] = "DESCRICAO"
VCABEC[2] = "CODIGO"
VCABEC[3] = "VALOR"

VCAMPOS[1] = "DESCRICAO"
VCAMPOS[2] = "CODP"
VCAMPOS[3] = "VALOR"

SEEK VCODP
	
IF .NOT. EOF()
	VCODP = CODP
ELSE
	VCODP = ""
ENDIF
	
SET ORDER TO 2
	
IF EMPTY(VCODP)
	GOTO TOP
ELSE
	SEEK VCODP
ENDIF
@ 08,24 CLEAR TO 21,76
@ 08,24 TO 21,76
@ 09,25 SAY SPACE(51)
CENTRA(09,25,76,"Procura de Produto")
DBEDIT(10,25,20,75,VCAMPOS,"ACHALETRA",0,VCABEC)

IF LASTKEY() # 27
	VCODP = CODP
	KEYBOARD CHR(13)		
ELSE
	VRET = ""
	KEYBOARD CHR(13)
	VUPD = .T.
ENDIF
	
SET ORDER TO 1

@ VLIN,VCOL
SETCOLOR(VCOLOR)
RESTORE SCREEN FROM VTELA
RETURN VCODP


RETURN VCODPROD



*******************
FUNCTION DELPRODUTO
*******************
PARAMETERS VCHAVE

USE PRODUTO INDEX PRODUTO1 INDEX PRODUTO2

PRIVATE VCOLOR,VTELA,VCAMPOS[4],VCABEC[4],VLIN,VCOL,VRET

VLIN = ROW()
VCOL = COL()
	
SAVE SCREEN TO VTELA
VCOLOR = SETCOLOR()

VCABEC[1] = "DESCRICAO"
VCABEC[2] = "CODIGO"
VCABEC[3] = "VALOR"

VCAMPOS[1] = "DESCRICAO"
VCAMPOS[2] = "CODP"
VCAMPOS[3] = "VALOR"

SEEK VCODP
	
IF .NOT. EOF()
	VCODP = CODP
ELSE
	VCODP = ""
ENDIF
	
SET ORDER TO 2
	
IF EMPTY(VCODP)
	GOTO TOP
ELSE
	SEEK VCODP
ENDIF
@ 08,24 CLEAR TO 21,76
@ 08,24 TO 21,76
CENTRA(09,25,76,"Dele‡ao de Produto")
DBEDIT(10,25,20,75,VCAMPOS,"ACHALETRA",0,VCABEC)
			@ 16,40 CLEAR TO 19,65
				@ 16,40 TO 19,65
				CENTRA(17,40,65,"Confimar Dele‡ao")
				@ 18,45 PROMPT " SIM "
				@ 18,53 PROMPT " NAO "
				MENU TO VOP
					DO CASE 
					CASE VOP=0
					
					CASE VOP=1
						DELE

			ENDCASE


IF LASTKEY() # 27
	VCODP = CODP
	KEYBOARD CHR(13)		
ELSE
	VRET = ""
	KEYBOARD CHR(13)
	VUPD = .T.
ENDIF
	
SET ORDER TO 1

@ VLIN,VCOL
SETCOLOR(VCOLOR)
RESTORE SCREEN FROM VTELA
VCODP="     "
RETURN VCODP




*****************
 PROCEDURE REO
*****************
SAVE SCREEN TO VTELAINDEX
@ 11,30 TO 13,50
CENTRA(12,25,55,"A g u a r d e")
IF VINDEX = "1" .OR. VINDEX = "T"
	USE CLIENTE
		INDEX ON PLACA TO CLIENTE1
		INDEX ON NOME TO CLIENTE2
ENDIF
IF VINDEX = "2" .OR. VINDEX = "T"
	USE PRODUTO
		INDEX ON CODP TO PRODUTO1
		INDEX ON DESCRICAO TO PRODUTO2
ENDIF
IF VINDEX - "T" .OR. VINDEX = "3"
	USE VENDAS
	INDEX ON DATA TO VENDAS
ENDIF
CLOSE ALL
RESTORE SCREEN FROM VTELAINDEX
RETURN
*******************
FUNCTION MSPRODUTO
******************
	PARAMETERS VCHAVE
	USE PRODUTO INDEX PRODUTO1 INDEX PRODUTO2

	PRIVATE VCOLOR,VTELA,VCAMPOS[4],VCABEC[4],VLIN,VCOL,VRET,VCOND
	VLIN = ROW()
	VCOL = COL()
	
   SAVE SCREEN TO VTELA12
	VCOLOR = SETCOLOR()

	
	VCABEC[1] = "DESCRICAO"
	VCABEC[2] = "CODGIO"
	VCABEC[3] = "VALOR"

*	VCABEC[3] = "DEPENDENTE 1"
*	VCABEC[4] = "DEPENDENTE 2"	
	
	VCAMPOS[1] = "DESCRICAO"
	VCAMPOS[2] = "CODP"
	VCAMPOS[3] = "VALOR"

*	VCAMPOS[3] = "DEP1" 
*	VCAMPOS[4] = "DEP2"	
	SET ORDER TO 2
	GO TOP
	IF EMPTY(VCODP)
		GOTO TOP
	ELSE
	SAVE SCREEN TO VTELAA
		ENVMSG("Aguande !!!  Procurando Registro","",.T.,.F.,.F.,.T.)
		VCOND = "(DESCRICAO = ALLTRIM(VCODP) .OR. (' '+ALLTRIM(VCODP)+' ')$(' '+ALLTRIM(DESCRICAO)+' '))"
	  	COPY TO LOCV FOR &VCOND
		USE LOCV
	RESTORE SCREEN FROM VTELAA
IF EOF()
		ENVMSG("Produto nao cadastrada!","",.F.,.F.,.F.,.F.)
ELSE
	@ 08,24 CLEAR TO 21,76
	@ 08,24 TO 21,76
	DBEDIT(10,25,20,75,VCAMPOS,0,0,VCABEC)
	IF LASTKEY() # 27
		VCODP = CODP
		KEYBOARD CHR(13)		
	ELSE
		VRET = ""
		KEYBOARD CHR(13)
		VUPD = .T.
	ENDIF

	SET ORDER TO 1
ENDIF
ENDIF
	@ VLIN,VCOL
	SETCOLOR(VCOLOR)
   RESTORE SCREEN FROM VTELA12
	RETURN VCODP
***************
FUNCTION PAUSE
**************
	PARAMETERS VKEY
	SET CURSO OFF
	INKEY(VKEY)
	SET CURSO ON
	RETURN .T.
**************
PROCEDURE DATA
**************
SAVE SCREEN TO VTELA
	@ 09,09 CLEAR TO 13,31
	@ 09,09 TO 13,31 DOUBLE
	VHORA=TIME()
	VDATA=DATE()
	@ 10,10 SAY "Hora..:  " GET VHORA PICT "99:99:99"
	@ 12,10 SAY "Data..:  " GET VDATA
	READ
	IF LASTKEY()#27
	 IF UPDATED()
		DATA = DTOC(VDATA)
		SWPRUNCMD("TIME &VHORA",0,"","")
		SWPRUNCMD("DATE &DATA",0,"","")
	 ENDIF
	ENDIF
RESTORE SCREEN FROM VTELA
RETURN
**************
PROCEDURE CABE
**************
SAVE SCREEN TO VTELA
	@ 05,02 CLEAR TO 20,77
	USE CONFIG
   VCA1=CA1
	VCA2=CA2
	VCA3=CA3
	VRO1=RO1
	VRO2=RO2
	VRO3=RO3
	@ 05,03 SAY "Cabecario"
	@ 06,03 TO 10,44
	@ 07,04 GET VCA1 PICT "@!"
	@ 08,04 GET VCA2 PICT "@!"
	@ 09,04 GET VCA3 PICT "@!"
	@ 11,03 SAY "Rodape"
	@ 12,03 TO 16,44
	@ 13,04 GET VRO1 PICT "@!"
	@ 14,04 GET VRO2 PICT "@!"
	@ 15,04 GET VRO3 PICT "@!"
	READ
	IF LASTKEY()#27
		REPLACE CA1 WITH VCA1
		REPLACE CA2 WITH VCA2
		REPLACE CA3 WITH VCA3
		REPLACE RO1 WITH VRO1
		REPLACE RO2 WITH VRO2
		REPLACE RO3 WITH VRO3
	ENDIF
RESTORE SCREEN FROM VTELA
RETURN
**************
PROCEDURE LOCA
**************
*****************
PROCEDURE PESSOAL
*****************
SAVE SCREEN TO VTELA
	USE CONFIG
	GO TOP
	VNOME=NOME
	VEND=END
	VCPF=CPF
	VTEL=TEL
	VBAIRRO=BAIRRO
	VUF=UF
	@ 05,02 CLEAR TO 20,77
	@ 07,10 TO 18,52
	@ 08,11 SAY "Empresa.."
	@ 09,11 GET VNOME PICT "@!"
	@ 10,11 SAY "Endereco "
	@ 11,11 GET VEND PICT "@!"
	@ 12,11 SAY "Bairro / Cidade"
	@ 13,11 GET VBAIRRO PICT "@!"
	@ 14,11 SAY "CPF"  
	@ 15,11 GET VCPF PICT "@!"
	@ 16,11 SAY "Tel.."
	@ 17,11 GET VTEL PICT "@!"
	READ
	IF LASTKEY()#27
		REPLACE NOME WITH VNOME, END WITH VEND, CPF WITH VCPF
		REPLACE BAIRRO WITH VBAIRRO, TEL WITH VTEL
	ENDIF
RESTORE SCREEN FROM VTELA
RETURN
PROCEDURE AN
Y = 0
p = 1
SET COLOR TO GR+/&PCOLOR
CLEAR
@ 01,01 CLEAR TO 23,78
SOBRA(00,00,6,79,"N/"+PCOLOR,"W+/"+PCOLOR)
SET COLOR TO GR+/&PCOLOR
CENTRA(01,00,80,"Todos Os direiro reseverdos")
CENTRA(02,00,80,"A Cleber de Almeida Soares")
CENTRA(03,00,80,"Liceciando Para")
CENTRA(04,00,80,"Moto Soccoro Lorinho")
CENTRA(05,00,80,"Visual Note Versao 2.0 Plus Net")


SET CURSO OFF
DO WHILE LASTKEY()#13 .AND. LASTKEY()#27
	SAVE SCREEN TO VTELA

		SET COLOR TO GR+/&PCOLOR
		SOBRA(15,Y,21,Y+30,"W+/"+PCOLOR,"N/"+PCOLOR)
		SET COLOR TO N/&PCOLOR
		CENTRA(16,Y,Y+30, "ÜÜÜÜÜÜÜÜÜÜÜÜÜ")
		CENTRA(17,Y,Y+30, "Û     Û     Û")
		CENTRA(18,Y,Y+30, "ÛÛÛÛÛÛÛÛÛÛÛÛÛ")
		CENTRA(19,Y,Y+30, "Û     Û     Û")
		CENTRA(20,Y,Y+30, "ßßßßßßßßßßßßß")
		VCOR=SETCOLOR()
		SET COLOR TO R/R
			@ 17,Y+10 SAY SPACE(5)
		SET COLOR TO B/B
			@ 19,Y+10 SAY SPACE(5)
		SET COLOR TO G/G
			@ 17,Y+16 SAY SPACE(5)
		SET COLOR TO GR+/R+
			@ 19,Y+16 SAY "ÛÛÛÛÛ"
		SET COLOR TO &VCOR
   	INKEY(0.1)
	RESTORE SCREEN FROM VTELA
	IF P = 1 
   	 Y = Y + 1
		FELIZ(10,72/2)
	    If Y = 50 
   	    P = 2
	    ENDIF
	ENDIF
	IF P = 2 
  		TRISTE(10,72/2)
		Y = Y - 1

	    IF Y = 0 
	        P = 1
		ENDIf
	ENDIF
ENDDO
SET CURSO ON
*		CENTRA(16,Y,Y+30, "ÜÜÜÜÜÜÜÜÜÜÜÜÜ")
*		CENTRA(17,Y,Y+30, "Û  Û     Û  Û")
*		CENTRA(18,Y,Y+30, "Û   ÛÛÛÛÛ   Û")
*		CENTRA(19,Y,Y+30, "Û  ÛßßßßßÛ  Û")
*		CENTRA(20,Y,Y+30, "ßßßßßßßßßßßßß")
CLEAR
************
FUNCTION PAR
************
PRIVATE VTELA,VCAMPOS[5],VCAB[5],VCOND,VCOND1,VCOND2
SAVE SCREEN TO VTELAW
SELE 1
USE CLIENTE 
	VCHAVE="PA"
	IF LASTKEY()#27
	
*     VCOND = "(NOME = ALLTRIM(VCHAVE) .OR. (' '+ALLTRIM(VCHAVE)+' ')$(' '+ALLTRIM(NOME)+' '))"
      VCOND = "(EMP = ALLTRIM(VCHAVE) .OR. (' '+ALLTRIM(VCHAVE)+' ')$(' '+ALLTRIM(EMP)+' '))"		
		SAVE SCREEN TO VTELAP
			ENVMSG("Aguande !!!  Procurando Registro","",.T.,.F.,.F.,.T.)
		RESTORE SCREEN FROM  VTELAP	
		
		IF .NOT. EMPTY(VCHAVE)
			USE CLIENTE INDEX CLIENTE1
			COPY TO E FOR &VCOND
			USE E
			IF EOF()
				USE
				
			ENDIF
				
		ENDIF	

		VCAMPOS[1] = "NOME"
		VCAMPOS[2] = "PLACA"
		VCAMPOS[3] = "EMP"

		VCAB[1] = "Nome"
		VCAB[2] = "Placa" 
		VCAB[3] = "Empresa"
		@ 09,24 TO 21,76 DOUBLE
		DBEDIT(10,25,20,75,VCAMPOS,0,0,VCAB)	
		
		IF LASTKEY()=13
			VEMP=PLACA
			VT=.T.
		KEYBOARD CHR(13)		
*		ELSE
*			VEMP="1111111"
*			VT=.T.
		ENDIF			
	ENDIF		

RESTORE SCREEN FROM VTELAW

CLOSE DATABASES

RETURN .T.
PROCEDURE DT
***************
* CALENDARIO  *
***************
AS=SETCOLOR()
PRIVATE VTELACALE
SET CENTURY ON

SAVE SCREEN TO VTELACALE

VDATA1=CTOD("01"+SUBSTR(DTOC(DATE()),3,8))

SET CURSOR OFF
DO WHILE .T. .AND. LASTKEY()#27
		@ 22,02 SAY SPACE(76)
		DIA="1"
		VDATA2=VDATA1
		SSS=SETCOLOR()
		LINHA=1
		VLINHA=11
		VNOMEMES=MES(VDATA1)
		VPOS=POS(VDATA1)
*		@ 08,40 SAY SPACE(33)*
*		@ 08,50 SAY "Calendario "
		@ 09,39 CLEAR TO 17,73
		SOBRA(08,39,17,74,"N/GR","W+/GR") 
		@ 09,50 SAY VNOMEMES+" /"+STR(YEAR(VDATA1))
		@ 10,40 SAY "DOM  SEG  TER  QUA  QUI  SEX  SAB"	
		
		X=0	
*		@ 05,21 TO 07,57								
		SET MESSAGE TO 22 CENTER
*		@ 06,41 SAY VNOMEMES+" DE "+STR(YEAR(VDATA1))
		DO WHILE MONTH(VDATA2)=MONTH(VDATA1)
			@ VLINHA,VPOS PROMPT  DIA MESSAGE DIASEM(VDATA1+X)+" dia "+DIA+SPACE(2)+VNOMEMES+" DE "+STR(YEAR(VDATA1))
			DIA=ALLTRIM(STR(VAL(DIA)+1))
			VDATA2=VDATA2+1
			VPOS=VPOS+5
			X=X+1
			IF VPOS>70
				VPOS=40
				VLINHA=VLINHA+1
 		ENDIF
	
		ENDDO
		MENU TO VOPCAO
		IF LASTKEY()=13
			VDE=VDATA1-VAL(DIA)
			VATE=VDATA1-VAL(DIA)
			EXIT
		ENDIF
*		INKEY(0)

		DO CASE
		
			CASE LASTKEY()=27
				EXIT
	
			CASE LASTKEY()=18
				VDATA1=VDATA1+35
	
			CASE LASTKEY()=3
				VDATA1=VDATA1-28
	
		ENDCASE
	
		VDATA1=CTOD("01"+SUBSTR(DTOC(VDATA1),3,8))

ENDDO

RESTORE SCREEN FROM VTELACALE
SET MESSAGE TO 03 CENTER
SET COLOR TO &AS
SET CURSOR ON

RETURN
SET CURSO OFF	
SET MESSAGE TO 03 CENTER
PROCEDURE EST34_PRG
*******************************
* LOC34 - PESQUISA POR CLASSE *
*******************************
SAVE SCREEN TO VTELA
USE CONFIG
VCOR=SETCOLOR()
VNOME1="  1    =   AZUL       "
VNOME2="  2    =   VERMELHO   "
VNOME3="  3    =   VERDE      "
VNOME4="  4    =  AZUL CLARA  "
VNOME5="  5    =    AMAROM    "
VNOME6="  6    =     ROSA     "
VNOME7="  7    =    BRACO     "
VRE="0"
*@ 05,02 CLEAR TO 20,77
SET COLOR TO N/W
@ 05,28 CLEAR TO 18,51
SOBRA(05,28,19,51,"W+/"+PCOLOR,"N/"+PCOLOR)
SET COLOR TO GR+/B
CENTRA(06,00,80,VNOME1)
SET COLOR TO GR+/R
CENTRA(08,00,80,VNOME2)
SET COLOR TO GR+/G
CENTRA(10,00,80,VNOME3)
SET COLOR TO GR+/BG
CENTRA(12,00,80,VNOME4)
SET COLOR TO GR+/GR
CENTRA(14,00,80,VNOME5)
SET COLOR TO GR+/RB
CENTRA(16,00,80,VNOME6)
SET COLOR TO &VCOR
@ 18,30 SAY "Escolha..:  " GET VRE VALID VRE$"123456"
VG=SETCOLOR()
SET COLOR TO GR+*/&PCOLOR
RODAPE("DEPOIS RE-INICIA O PROGRAMA",.T.)
READ
IF LASTKEY()#27

	IF VRE="1"
		VCA="B"
	ELSEIF VRE="2"
		VCA="R"
	ELSEIF VRE="3"
		VCA="G"
	ELSEIF VRE="4"
		VCA="BG"
	ELSEIF VRE="5"
		VCA="GR"
	ELSEIF VRE="6"
		VCA="RB"
	ELSE
		VCA="BG"
	ENDIF
REPLACE C WITH VCA
ENDIF

SET COLOR TO &VCOR
RESTORE SCREEN FROM VTELA
CLOSE DATABASES
RETURN
******************************
FUNCTION TEA
PRIVATE VCAMPOS[5],VCAB[5]
SAVE SCREEN TO VTELA_A1
CLEAR
VT=""
X=0
SET WRAP ON
@ 00,00 TO 22,42 DOUBLE
@ 01,01 SAY "Nome"
@ 01,44 SAY "Placa"
@ 01,55 SAY "Telefone"
@ 01,67 SAY "Valor"
@ 01,53 TO 21,53 DOUBLE
@ 02,01 TO 02,78 DOUBLE
@ 00,00 TO 22,78 DOUBLE
@ 01,65 TO 22,65 DOUBLE
@ 00,65 SAY "Ë"
@ 22,65 SAY "Ê"
@ 00,53 SAY "Ë"
@ 22,53 SAY "Ê"
@ 00,42 SAY "Ë"
@ 22,42 SAY "Ê"
@ 02,42 SAY "Î"
@ 02,53 SAY "Î"
@ 02,65 SAY "Î"
@ 02,00 SAY "Ì"
@ 02,78 SAY "¹"
@ 23,15 PROMPT "     Por Nome       "
@ 23,42 PROMPT "     Por Placa      "
MENU TO VOPCAO
@ 23,00 SAY SPACE(80)
IF LASTKEY()=27
	CLEAR
	CANCEL
ENDIF
DO CASE
	CASE VOPCAO = 0
		USE CLIENTE
		INDEX ON NOME TO CLIENTE2
		VTIPO = "CLIENTE2"
	CASE VOPCAO = 1
		USE CLIENTE
		INDEX ON NOME TO CLIENTE2
		VTIPO = "CLIENTE2"
	CASE VOPCAO = 2
		USE CLIENTE
		INDEX ON PLACA TO CLIENTE1
		VTIPO = "CLIENTE1"
ENDCASE
P=3
USE CLIENTE INDEX &VTIPO
GO TOP

DO WHILE .T.
		VNOME=NOME
		VPLACA=PLACA
		VTEL=TEL
		VVALOR=TOTAL
		@ P,01 SAY VNOME PICT "@!"
		@ P,44 SAY VPLACA PICT "@!"
		@ P,55 SAY VTEL PICT "9999-9999"
		@ P,66 SAY VVALOR PICT "999,999.99"
		IF P=21
			EXIT
		ENDIF
		SKIP

		P=P+1
	ENDDO
X=ROW()
Y=0
SPACE=78
VLIN=0
VCOL=24
DESL=0
TAM=0
VCHR=1

TD=""  
@ VCOL,VLIN+1 SAY ""
WP=0
DO WHILE .T.
	VNOME=SPACE(30)
	VPLACA=SPACE(8)
	VTEL=0
	VVALOR=0
USE CLIENTE INDEX &VTIPO
	@ 24,00 SAY SPACE(80)
	@ 24,00 SAY UPPER(TD)
	A=INKEY(0)
	  IF A=13
			A=0
	  ENDIF
     IF  LASTKEY()=5
			G()
			LOOP
		ENDIF
		IF LASTKEY()=24 
			G()
			LOOP
		ENDIF
      IF LASTKEY()=4 .OR. LASTKEY()=7 
			G()
			LOOP
		ENDIF
      IF LASTKEY()=6 .OR. LASTKEY()=3 
			G()
			LOOP
		ENDIF
      IF LASTKEY()=18 .OR. LASTKEY()=1 
			G()
			LOOP
		ENDIF
      IF LASTKEY()=22 .OR. LASTKEY()=390 
			G()
			LOOP
		ENDIF
      IF LASTKEY()=389 .OR. LASTKEY()=-9 
			G()
			LOOP
		ENDIF
      IF LASTKEY()=-8 .OR. LASTKEY()=-7 
			G()
			LOOP
     ENDIF
     IF LASTKEY()=-6 .OR. LASTKEY()=-5 
			G()
         LOOP
      ENDIF 
		IF LASTKEY()=-4 .OR. LASTKEY()=-3 
			G()
			LOOP
		ENDIF
      IF  LASTKEY()=-2 .OR. LASTKEY()=-1 
			G()
			LOOP
		ENDIF
		IF  LASTKEY()=28 
			G()
			LOOP
		ENDIF
   	IF WP=0
			IF LASTKEY()=8
				LOOP
			ENDIF
		ENDIF
		IF A=8 .OR. A=19
      	 IF TAM>0
	        	  DESL=DESL - 1
              TAM = TAM - 1
              TD = LEFT(TD,TAM)
					WP=WP-1
             @ VCOL,Y+DESL SAY  SPACE(5)
              @ VCOL,Y+DESL SAY  ""
              TAM=LEN(TD)
*				  TAM=TAM-1
 *             VCHR=VCHR-1
*					@ 00,00 SAY TD
*					INKEY(0)
					SET SOFTSEEK ON
					SEEK UPPER(TD)
					SET SOFTSEEK OFF
					P=3
					DO WHILE .T.
						VNOME=NOME
						VPLACA=PLACA
						VTEL=TEL
						VVALOR=TOTAL
						@ P,01 SAY VNOME PICT "@!"
						@ P,44 SAY VPLACA 
						@ P,55 SAY VTEL PICT "9999-9999"
						@ P,66 SAY VVALOR PICT "999,999.99"
						IF P=21
							EXIT
						ENDIF
						SKIP
						P=P+1
					ENDDO
		        LOOP
            ENDIF
        ENDIF
	IF LASTKEY()=13 
		SAVE SCREEN TO VLL
		CLEAR
		SET SOFTSEEK ON
		SEEK UPPER(TD)
		SET SOFTSEEK OFF
		VCAMPOS[1] = "SUBS(NOME,1,25)"
		VCAMPOS[2] = "PLACA"
		VCAMPOS[3] = "SUBS(EMP,1,25)"
		VCAMPOS[5] = "TOTAL"
		VCAMPOS[4] = "TEL"

		VCAB[1] = "Nome"
		VCAB[2] = "Placa" 
		VCAB[3] = "Empresa"
		VCAB[5] = "Valor que Deve"
		VCAB[4] = "Telefone"

   	@ 00,00 TO 23,78 DOUBLE
*		BROWSE(01,01,22,77)
		DBEDIT(01,01,22,77,VCAMPOS,0,0,VCAB)
		VCODIGO=PLACA
		SAVE SCREEN TO VTEA_A
			DO TE1
		RESTORE SCREEN FROM VTEA_A
		TD=""
		RESTORE SCREEN FROM VLL
   ENDIF
	IF LASTKEY()=27
		EXIT
	ENDIF
	DESL=DESL+1
	TD=TD+CHR(A)
	WP=WP+1
	@ 24,00 SAY SPACE(79)
   @ VCOL,00 SAY UPPER(TD)
   TAM=LEN(TD)
   X=X+1
   VCHR=VCHR+1
	SET SOFTSEEK ON
	SEEK UPPER(TD)
	SET SOFTSEEK OFF
	@ 00,00 TO 22,42 DOUBLE
	@ 01,01 SAY "Nome"
	@ 01,44 SAY "Placa"
	@ 01,55 SAY "Telefone"
	@ 01,67 SAY "Valor"
	@ 01,53 TO 21,53 DOUBLE
	@ 02,01 TO 02,78 DOUBLE
	@ 00,00 TO 22,78 DOUBLE
	@ 01,65 TO 22,65 DOUBLE
	@ 00,65 SAY "Ë"
	@ 22,65 SAY "Ê"
	@ 00,53 SAY "Ë"
	@ 22,53 SAY "Ê"
	@ 00,42 SAY "Ë"
	@ 22,42 SAY "Ê"
	@ 02,42 SAY "Î"
	@ 02,53 SAY "Î"
	@ 02,65 SAY "Î"
	@ 02,00 SAY "Ì"
	@ 02,78 SAY "¹"
	
	P=3
	DO WHILE .T.
		VNOME=NOME
		VPLACA=PLACA
		VTEL=TEL
		VVALOR=TOTAL
		@ P,01 SAY VNOME PICT "@!"
		@ P,44 SAY VPLACA PICT "@!"
		@ P,55 SAY VTEL PICT "9999-9999"
		@ P,66 SAY VVALOR PICT "999,999.99"
		IF P=21
			EXIT
		ENDIF
		SKIP
		P=P+1
	ENDDO
	P=3
ENDDO
RESTORE SCREEN FROM VTELA_A1
RETURN .T.
FUNCTION G
TONE(700, 2)
TONE(900, 5)
RETURN .T.
PROCEDURE TE1
SAVE	SCREEN TO VTELA_A2
USE CLIENTE INDEX CLIENTE1 INDEX CLIENTE2
VCOR_01=SETCOLOR()
SET COLOR TO W+/&PCOLOR,RG+/R
@ 04,02 CLEAR TO 20,75
SOBRA(04,02,20,75,PCOLOR+"+/"+PCOLOR,"N/"+PCOLOR)

*@ 05,02  TO 19,75

IF LAST()#27
	
*	VCODIGO=STRZERO(VAL(VCODIGO))
	SEEK VCODIGO
		IF EOF()
				VTOTAL=0
				VTEL1=0
				VNOME=SPACE(40)
				VEND=SPACE(40)
				VBAIRRO=SPACE(40)
				VCIDADE=SPACE(40)
				VUF="MG"
				VCPF=SPACE(14)
				VTEL=0
				VDATA=DATE()
				VNASC=DATE()
				VRG=SPACE(13)
				XY="Novo Cliente"
				VEMP=SPACE(40)
				GRAVA=.T.
				VOBS=SPACE(1)
				VOBS1=SPACE(50)
				VOBS2=SPACE(50)
				VOBS3=SPACE(50)
				VDATACON1=DATE()
				VCON=SPACE(1)
	         @ 06,03 SAY SPACE(30)
            @ 06,03 SAY "Placa     "+ VCODIGO 
		ELSE
				VDATACON1 = DATACON1
				VCON=CON
				VTOTAL = TOTAL
				VTEL1=TEL1
				VNOME=NOME
				VEND=END
				VBAIRRO=BAIRRO
				VCIDADE=CIDADE
				VCPF=CPF
				VUF=UF
				VTEL=TEL
				VDATA=DATA
				VNASC=NASC
				VRG=RG
				XY="Alterando  Cliente"
				VEMP=EMP
				GRAVA=.F.
				VOBS=OBS
				VOBS1=OBS1
				VOBS2=OBS2
				VOBS3=OBS3
*            @ 06,03 SAY SPACE(30)

		ENDIF
	             @ 06,03 SAY "Placa    " GET VCODIGO 
    		       @ 07,03 SAY "Empresa  " GET VEMP PICT "@!"
                @ 08,03 SAY "Nome     " GET VNOME PICT "@!"
                @ 09,03 SAY "Endre‡o  " GET VEND PICT "@!" 
                @ 10,03 SAY "Bairro   " GET VBAIRRO PICT "@!"
                @ 11,03 SAY "Cidade   " GET VCIDADE
                @ 12,03 SAY "UF       " GET VUF PICT "@!"
                @ 13,03 SAY "Telefone " GET VTEL PICT "@Z 9999-9999"
                @ 13,25 SAY "OU " GET VTEL1 PICT "@z 9999-9999"
                @ 14,03 SAY "RG       " GET VRG PICT "@!"
                @ 14,40 SAY "Data de Nasc." GET VNASC 
					 @ 15,03 SAY "CPF      " GET VCPF PICT "999.999.999-99"
					 @ 15,40 SAY "Data         " GET VDATA
					 @ 16,03 SAY "TOTAL    "  GET VTOTAL PICT "999,999.99"
					 @ 16,40 SAY "Obs          "  GET VOBS PICT "@!" VALID VOBS$"SN" 
  					 @ 17,03 SAY "Consocio " GET VCON PICT "@!" VALID VCON$"SN" 					
					 @ 18,03 SAY "DIA       "+DTOC(VDATACON1)
	   	       READ
					IF LASTKEY()#27
						IF VOBS="S"
							SAVE SCREEN TO VTELA5
							@ 17,14 TO 21,65
							CENTRA(17,14,65,"Observacao")
							@ 18,15 GET VOBS1 
							@ 19,15 GET VOBS2 
							@ 20,15 GET VOBS3 
							READ	
							RESTORE SCREEN FROM VTELA5
						ENDIF	
					IF VCON="S"
						@ 18,03 SAY "DIA      " GET VDATACON1
						READ
					ENDIF
				ENDIF
				IF LASTKEY()#27
					@ 16,40 CLEAR TO 19,65
					@ 16,40 TO 19,65
					CENTRA(17,40,65,"Confimar Grava‡ao")
					@ 18,45 PROMPT " SIM "
					@ 18,53 PROMPT " NAO "
					MENU TO VOP
						DO CASE 
						CASE VOP=0

						CASE VOP=1
							IF GRAVA=.T.
								APPEND BLANK            
							ENDIF
								REPLACE PLACA WITH VCODIGO , NOME WITH VNOME, EMP WITH VEMP ,END WITH VEND
								REPLACE DATA WITH VDATA, BAIRRO WITH VBAIRRO,  CIDADE WITH VCIDADE, UF WITH VUF
								REPLACE TEL WITH VTEL, TEL1 WITH VTEL1 ,RG WITH VRG,CPF WITH VCPF, NASC WITH VNASC
								REPLACE OBS WITH VOBS, OBS1 WITH VOBS1, OBS2 WITH VOBS2, OBS3 WITH VOBS3, TOTAL WITH VTOTAL
								REPLACE CON WITH VCON, DATACON1 WITH VDATACON1
						ENDCASE
				ENDIF                   
ENDIF
SET COLOR TO &VCOR_01
RESTORE SCREEN FROM VTELA_A2
RETURN 
********************
PROCEDURE PRODUTOREL
********************
SAVE SCREEN TO VTELAP
	SAVE SCREEN TO VLP
	@ 10,10 CLEAR TO 12,35
	@ 10,10 TO 12,35
	@ 11,11 PROMPT "  Video   "
	@ 11,23 PROMPT "Impressora"
	MENU TO VO
	RESTORE SCREEN FROM VLP
		DO CASE
			CASE VO=1
				SET PRINTER TO EST
			CASE VO=2
			 SAVE SCREEN TO VT
				DO IMPR
			 RESTORE SCREEN FROM VT
			ENDCASE

	IF LASTKEY()#27
		USE PRODUTO INDEX PRODUTO2

		SET DEVICE TO PRINT
		IF VO=1
			@ 00,00 SAY DATE()
			CENTRA(00,00,80,"Relatorio de Produto")
			@ 00,69 SAY TIME()
			@ 01,00 SAY REPLICATE("-",80)
			@ 02,00 SAY "Descricao                                Codigo       Q. C."
			@ 03,00 SAY REPLICATE("-",80)
			X=4
			Q=0

			DO WHILE .NOT. EOF()
				VDESCRICAO = DESCRICAO
*				VVALOR = VALOR
				VCODIGO = CODP
				VQTD=CONT-QTD
				VCONT=CONT
				IF VCONT <= VQTD
					IF VCONT <> 0
						@ X,00 SAY LEFT(VDESCRICAO,30)
						@ X,41 SAY VCODIGO
	*					@ X,40 SAY VVALOR
						@ X,48 SAY VQTD
						X=X+2
						Q=Q+1
					ENDIF
				ENDIF
				SKIP
			ENDDO
			@ X+2,00 SAY "TOTAL DE PRODUTO..: " +STR(Q)
			SET DEVICE TO SCREEN 
		IF VO=1
			SET PRINTER TO 
	      SWPRUNCMD("BROWSE EST.PRN",0,"","")
		ENDIF
	ELSE
			SET PRINTER TO LL
		   SET DEVICE TO PRINT
*			@ 00,00 SAY DATE()
*			CENTRA(00,00,80,"Relatorio de Produto")
*			@ 00,69 SAY TIME()
*			@ 01,00 SAY REPLICATE("-",80)
*			@ 02,00 SAY "Q.C  Descri‡Æo     Codigo " 
*			@ 03,00 SAY REPLICATE("-",80)
*			X=4
*			Q=0
*
*			DO WHILE .NOT. EOF()
*				VDESCRICAO = DESCRICAO
**				VVALOR = VALOR
*				VCODIGO = CODP
*				VQTD=CONT-QTD
*				VCONT=CONT
*				IF VCONT <= VQTD
*					IF VCONT <> 0
*						@ X,00 SAY VQTD PICT "99"
*						@ X,03 SAY LEFT(VDESCRICAO,23)
*						@ X,27 SAY VCODIGO
*						X=X+2
*						Q=Q+1
*					ENDIF
**				ENDIF
*				SKIP
*			ENDDO
*			@ X+2,00 SAY "TOTAL DE PRODUTO..: " +STR(Q)
*			@ 00,00 SAY ""
			@ 00,00 SAY DATE()
			CENTRA(00,00,80,"Relatorio de Produto")
			@ 00,69 SAY TIME()
			@ 01,00 SAY REPLICATE("-",80)
			@ 02,00 SAY "Descrica                                 Codigo       Q. C."
			@ 03,00 SAY REPLICATE("-",80)
			X=4
			Q=0

			DO WHILE .NOT. EOF()
				VDESCRICAO = DESCRICAO
*				VVALOR = VALOR
				VCODIGO = CODP
				VQTD=CONT-QTD
				VCONT=CONT
				IF VCONT <= VQTD
					IF VCONT <> 0
   					@ X,00 SAY VQTD PICT "99"
						@ X,03 SAY LEFT(VDESCRICAO,23)
						@ X,27 SAY VCODIGO
						X=X+2
						Q=Q+1
					ENDIF
				ENDIF
				SKIP
			ENDDO
			@ X+2,00 SAY "TOTAL DE PRODUTO..: " +STR(Q)
			@ X+20,00 SAY "" 
			SET DEVICE TO SCREEN 
         SWPRUNCMD("COPY LL.PRN LPT1",0,"","")					
		IF VO=1
			SET PRINTER TO 
	      SWPRUNCMD("BROWSE EST.PRN",0,"","")
		ENDIF
	ENDIF
ENDIF	
RESTORE SCREEN FROM VTELAP
RETURN
********************
PROCEDURE RPRODUTO
********************
SAVE SCREEN TO VTELAP
	SAVE SCREEN TO VLP
	@ 10,10 CLEAR TO 12,35
	@ 10,10 TO 12,35
	@ 11,11 PROMPT "  Video   "
	@ 11,23 PROMPT "Impressora"
	MENU TO VO
	RESTORE SCREEN FROM VLP
		DO CASE
			CASE VO=1
				SET PRINTER TO EST.PRN
			CASE VO=2
			 SAVE SCREEN TO VT
				DO IMPR
			 RESTORE SCREEN FROM VT
			ENDCASE

	IF LASTKEY()#27
		USE PRODUTO INDEX PRODUTO2
		SET DEVICE TO PRINT
		@ 00,00 SAY DATE()
		CENTRA(00,00,80,"Relatorio de Produto")
		@ 00,69 SAY TIME()
		@ 01,00 SAY REPLICATE("-",80)
		@ 02,00 SAY "Descricao                               Codigo         Valor     Qtd.Comprar"
		@ 03,00 SAY REPLICATE("Í",80)
		X=4
		Q=0
		DO WHILE .NOT. EOF()
			VDESCRICAO = DESCRICAO
			VVALOR =VALOR
			VCODIGO = CODP
			VQTD=CONT-QTD
			VCONT=CONT
			@ X,00 SAY VDESCRICAO
			@ X,41 SAY VCODIGO
			@ X,50 SAY VVALOR
			@ X,65 SAY VQTD
			X=X+2
			Q=Q+1
			SKIP
		ENDDO
		@ X+2,00 SAY "TOTAL DE PRODUTO..: " +STR(Q)
	SET DEVICE TO SCREEN 
	IF VO=1
		SET PRINTER TO 
      SWPRUNCMD("BROWSE EST.PRN",0,"","")
	ENDIF
ENDIF	
RESTORE SCREEN FROM VTELAP
RETURN
FUNCTION MSGBOX									&& apresenta mensagem de advertencia
	SAVE SCREEN TO VTELA_MSG_BOX
	SET CURSO OFF
	PARAMETERS VMSG1

	PRIVATE VCOLOR1,VCOLOR2,VPOS,VRESP,VLOOP

	CLEAR TYPEAHEAD
	
	VRESP = " "
	VCOLOR1 = SETCOLOR()

	@ 11, 6 TO 13,73 DOUBLE
*	SOBRA1(11,6,13,73,"W/"+PCOLOR,"I/"+PCOLOR) 
	SET COLOR TO &VCTITU
	@ 12,7 SAY SPACE(66)
	VPOS = CENTRA(12,7,72,VMSG1)
	INKEY(0)
	SETCOLOR(VCOLOR1)
	SET CURSO ON
	RESTORE SCREEN FROM VTELA_MSG_BOX
	RETURN VRESP
	
*** fim da funcao MSGBOX
FUNCTION PAGO1
	IF LASTKEY()>31 .AND. LASTKEY()<128
		VRET = 2
		RODAPE(PAGO,.F.)	
		DO LA
	ELSEIF LASTKEY()=27
		VRET=0
		DO LA
	ELSE
		RODAPE(PAGO,.F.)	
		VRET=1
		DO LA
	ENDIF
	TIPO=.T.
RETURN VRET
PROCEDURE LA
SAVE SCREEN TO M
IF TIPO=.T.
	VVALOR=VALOR
	VNOME=NOME
	VDATA=DATA
	VDATAE=DATAE
	IF LASTKEY()#27
		IF LASTKEY()=13
			@ 16,40 CLEAR TO 19,65
			@ 16,40 TO 19,65
			CENTRA(17,40,65,"Foi Pago?")
			@ 18,45 PROMPT " SIM "
			@ 18,53 PROMPT " NAO "
   		MENU TO VOP
			IF VOP=0
				VRET=0
			ELSEIF VOP=1
				REPLACE PAGO WITH "SIM"
				REPLACE P WITH 1
			ENDIF
		ENDIF
	ENDIF
ENDIF
RESTORE SCREEN FROM M
FUNCTION TRISTE
PARAMETERS P1,P2,P3
	VCOR=SETCOLOR()
	SET COLOR TO W+/&PCOLOR

	SOBRA(P1-1,P2-1,P1+4,P2+9,PCOLOR+"+/"+PCOLOR,"N/"+PCOLOR)

*	@ P1-1,P2 SAY "'''''''''"
	@ P1,P2+1 SAY   "__   __"
	@ P1+1,P2 SAY  "(®¯) (®¯)"
	@ P1+2,P2+4 SAY CHR(127)
	@ P1+3,P2+1 SAY  "Ú-----¿"

	SET COLOR TO &VCOR
RETURN .T.

FUNCTION FELIZ
PARAMETERS P1,P2,P3
	VCOR=SETCOLOR()
	SET COLOR TO W+/&PCOLOR

	SOBRA(P1-1,P2-1,P1+4,P2+9,PCOLOR+"+/"+PCOLOR,"N/"+PCOLOR)

*	@ P1-1,P2 SAY "'''''''''"
	@ P1,P2+1 SAY   "__   __"
	@ P1+1,P2 SAY  "(®¯) (®¯)"
	@ P1+2,P2+4 SAY CHR(127)
	@ P1+3,P2+1 SAY  "À-----Ù"

	SET COLOR TO &VCOR
RETURN .T.

FUNCTION TAL
PARAMETERS P1,P2,P3
	VCOR=SETCOLOR()
	SET COLOR TO W+/&PCOLOR

	SOBRA(P1-1,P2-1,P1+4,P2+9,PCOLOR+"+/"+PCOLOR,"N/"+PCOLOR)

*	@ P1-1,P2 SAY "'''''''''"
	@ P1,P2+1 SAY   "__   __"
	@ P1+1,P2 SAY  "(®¯) (®¯)"
	@ P1+2,P2+4 SAY CHR(127)
	@ P1+3,P2+1 SAY  "-------"

	SET COLOR TO &VCOR
RETURN .T.
FUNCTION FRAME
PARAMETERS VNomeFrame,VLINI,VCOLI,VLINF,VCOLF,SIM
IF SIM=.T.
	@ VLINI,VCOLI TO VLINF,VCOLF
ELSE
	@ VLINI,VCOLI TO VLINF,VCOLF DOUBLE
ENDIF
	@ VLINI,VCOLI+1 SAY VNomeFrame
RETURN .T.
*********************
FUNCTION COMBOCLIENTE
*********************
*PARAMETERS 
USE CLIENTE INDEX CLIENTE2 INDEX CLIENTE1
GO TOP
CONT = 0
DO WHILE !EOF()
	CONT = CONT + 1
	SKIP
ENDDO
PRIVATE VTELA,VOPCAO,VOPCOES[CONT],VMSG[CONT]
VCOR=SETCOLOR()

SAVE SCREEN TO VTELA 
GO TOP
	X=1
	DO WHILE !EOF()
		VOPCOES[X] = NOME
		VMSG[X] = ""
		X=X+1
		SKIP
	ENDDO

X=1
DO WHILE .T.

	VHELP = "ASPR1"	
	VOPCAO = SUBMENU1 (5,VOPCOES,VMSG,8,10,.T.,.T.)
	VHELP = "" 
	IF LASTKEY()=27
		EXIT
   ELSEIF LASTKEY()=13
		EXIT
	ENDIF


ENDDO
@ 00,00 SAY NOME
INKEY(0)
RESTORE SCREEN FROM VTELA
RETURN .T.
SET COLOR TO &VCOR

*****************************************************************
FUNCTION SUBMENU1										&& menu pop-up c/ mensagens

	PARAMETERS VCONTOP,VOPCOES,VMSG,VLIN,VCOL,VLIMPA,VTIPO

	PRIVATE VOPCAO,VLINM
	VCORSUBMENU=SETCOLOR()
	SET COLOR TO W+/&PCOLOR,GR+/N
	IF VLIMPA
*		@  8, 2 CLEAR TO 20,77
	ELSE
 *               @ 16, 2 CLEAR TO 20,77
	ENDIF
        VLINM = IIF(VLIN+VCONTOP<19,VLIN+VCONTOP,19)
	IF VTIPO=.T.
        SOBRA(VLIN,VCOL,VLINM+1,VCOL+20,PCOLOR+"+/"+PCOLOR,"N/"+PCOLOR)
	ELSE
        @ VLIN,VCOL TO VLINM+1,VCOL+20
	ENDIF
	KEYBOARD CHR(31)
   VOPCAO = ACHOICE (VLIN+1,VCOL+1,VLINM,VCOL+19,VOPCOES,.T.,"OPMSG1")
   IF VTIPO=.T.
	       SOBRAL(VLIN,VCOL,VLINM+1,VCOL+20,"I/"+PCOLOR,PCOLOR+"+/"+PCOLOR)
		ENDIF
*	    FELIZ(15,03)
		 @ 15,02 CLEAR TO 20,15
	SET COLOR TO &VCORSUBMENU
	RETURN VOPCAO

*** fim da funcao SUBMENU1

FUNCTION OPMSG1											&& mensagem p/ menu pop-up

	PARAMETERS VMODO,VPOS,VTECLA
	PRIVATE VRESP
*	@ 18,13 SAY SPACE(65)
	CENTRA(18,2,78,VMSG[VPOS])
	IF LASTKEY()=24
		IF X<0
			@ 00,00 SAY VOPCOES[X]
			@ 01,00 SAY X
			X=X+1
		ENDIF
	ELSEIF LASTKEY()=5
	IF X>CONT
			@ 01,00 SAY X
			@ 00,00 SAY VOPCOES[X]+" "+STR(X)
			X=X-1
		ENDIF
	ENDIF
	DO CASE
		CASE VMODO = 1
			VRESP = 2
*			KEYBOARD CHR(30)
				
		CASE VMODO = 2
			VRESP = 2
*			KEYBOARD CHR(31)
				
		CASE VMODO = 3
			DO CASE
				CASE LASTKEY() = 13
					VRESP = 1
			
				CASE LASTKEY() = 27
					VRESP = 0
			
				CASE LASTKEY() = 1
					VRESP = 2
*					KEYBOARD CHR(31)
			
						CASE LASTKEY() = 6
                                       VRESP = 2
                                       KEYBOARD CHR(30)
                                         
                               CASE LASTKEY() = 19 .OR. LASTKEY() = 4
					VRESP = 0
					KEYBOARD CHR(LASTKEY())
			
				CASE ASCAN(VOPCOES,CHR(LASTKEY())) # 0
					VRESP = 3
*					KEYBOARD CHR(13)
						
				OTHERWISE
					VRESP = 2
			ENDCASE
			
		OTHERWISE
			VRESP = 2
				
	ENDCASE
	
	RETURN VRESP


*** fim da funcao OPMSG
PROCEDURE I
USE VENDAS
INDEX ON DATA TO V
SET INDEX V
FUNCTION BOX   							&& apresenta mensagem de advertencia
PARAMETERS VMSG1
	SET CURSO OFF

	PRIVATE VCOLOR1,VCOLOR2,VPOS,VRESP,VLOOP
	CLEAR TYPEAHEAD
	VRESP = " "
	VCOLOR1 = SETCOLOR()
	@ 11, 6 TO 13,73 DOUBLE
	SET COLOR TO &VCTITU
	@ 12,7 SAY SPACE(66)
	VPOS = CENTRA(12,7,72,VMSG1)
	SETCOLOR(VCOLOR1)
	SET CURSO ON
RETURN VRESP
	
*** fim da funcao Box
************************************
* FUN€ÇO DE CARREGAMENTO DE VARIAS,*
PROCEDURE CARREGANDO
************************************
SAVE SCREEN TO VTELA_CLEBER
	SET COLOR TO
	CLEAR
	@ 03,06 TO 21,72 DOUBLE
	@ 04,07 SAY "0        0  0   00000   0   0      00      0    "
	@ 05,07 SAY " 0      0   0  0        0   0     0  0     0    "
	@ 06,07 SAY "  0    0    0   00000   0   0    0    0    0    "
	@ 07,07 SAY "   0  0     0        0  0   0   00000000   0    "
	@ 08,07 SAY "    00      0   00000    000   0        0  00000"

	@ 10,07 SAY "           00   0     000   0000000000  00000     0    000000"
	@ 11,07 SAY "           0 0  0    0   0      00      0       0 0    0    0"
 	@ 12,07 SAY "           0  0 0   0     0     00      000       0    0    0"
	@ 13,07 SAY "           0   00    0   0      00      0         0    0    0"
	@ 14,07 SAY "           0    0     000       00      00000     0  0 000000" 
	CENTRA(16,07,71,"Carregando O Programa.")
	USE PRODUTO
	X = 0
	DO WHILE !EOF()
		X = X + 1
		SKIP
	ENDDO
	PUBLIC PRODNOME[X]
	USE CLIENTE
	X = 0
	DO WHILE !EOF()
		X = X + 1 
		SKIP
	ENDDO
	CENTRA(16,07,71,"Carregando Arquivo de Produto")
	PUBLIC CLINOME[X]
	X = 1
	USE PRODUTO
	GO TOP
	DO WHILE !EOF()
		PRODNOME[X] = DESCRICAO
		X = X + 1
		SKIP
	ENDDO
	CENTRA(16,07,71,"Carregando Arquivo de Cliente")
	USE CLIENTE
	GO TOP
	X = 1
	DO WHILE !EOF()
		CLINOME[X] = NOME
		X = X + 1
		SKIP
	ENDDO
	CENTRA(16,07,71,"Arquivo Completo,Continuado a carregar o programa.")
	INKEY(0)      
*************
FUNCTION HELP
*************
PARAMETERS VRUN
SAVE SCREEN TO VTELA_HELP
	SET CURSO ON
	@ 05,10 TO 20,70 DOUBLE
	@ 05,70 SAY CHR(24)
	@ 20,70 SAY CHR(25)
	CENTRA(05,10,69," Ajuda do Sistema ")
	VARQ = "\WINDOWS\CONFIG.TXT"
	VNOME = MEMOREAD(VARQ)
	VNOME = MEMOEDIT(VNOME,06,11,19,69,.F.)
RESTORE SCREEN FROM VTELA_HELP
RETURN .T.
