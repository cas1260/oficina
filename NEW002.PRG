PROCEDURE A_CAL
***************
* CALENDARIO  *
***************
AS=SETCOLOR()
PRIVATE VTELACALE
SET CENTURY ON

SAVE SCREEN TO VTELACALE

VDATA1=CTOD("01"+SUBSTR(DTOC(DATE()),3,8))
VLIN = 4
VCOL = 39
VCAL = DATE()
P_COR = SETCOLOR()
SET COLOR TO W/RG
SET CURSO OFF
VTRUE = .T.
VMENU = ""
VPA=0
VLINA = 0
VCOLA = 0
VCOLB = 0
VLINB = 0
DO WHILE .T. .AND. LASTKEY()#27
*		@ 23,00 SAY SPACE(80)
		DIA="1"
		VDATA2=VDATA1
		SSS=SETCOLOR()
		LINHA=1
		VLINHA=05
		VNOMEMES=MES(VDATA1)
		VPOS=POS(VDATA1)
		@ 01,37 CLEAR TO 22,75
		@ 01,37 TO 22,75 
		@ 02,50 SAY VNOMEMES+" /"+STR(YEAR(VDATA1))
		@ 03,38 SAY "DOM   SEG  TER  QUA   QUI SEX  SAB"	
		X=0	
		DO WHILE MONTH(VDATA2)=MONTH(VDATA1)
			@ VLINHA,VPOS SAY STRZERO(VAL(DIA),2)
			DIA = ALLTRIM(STR(VAL(DIA)+1))
			VDATA2=VDATA2+1
			VPOS=VPOS+5
			X=X+1
			IF VTRUE = .T.
				VCOLA=VPOS
				VLINA = VLINHA
				VCOL = VPOS-6
				VTRUE = .F.
			ENDIF
			IF VPOS>70
				VPOS=40
				VLINHA=VLINHA+3
	 		ENDIF
			VCOLB = VPOS
			VLINB = VLINHA
		ENDDO
		VLINA = VLINHA
		DO WHILE LASTKEY()#27
			SAVE SCREEN TO VTELA_CAL
				SOBRAL(VLIN,VCOL,VLIN+2,VCOL+3,"W/RG","N/RG")
				INKEY(0)
			RESTORE SCREEN FROM VTELA_CAL
			DO CASE
			CASE LASTKEY()=13
				EXIT
				CASE LASTKEY()=27
					EXIT
				CASE LASTKEY()=43
					VDATA1=VDATA1+35
					VTRUE = .T.
					EXIT
				CASE LASTKEY()=45
					VDATA1=VDATA1-28
					VTRUE = .T.
					EXIT
				CASE LASTKEY() = 24
					IF VLIN < 19
						VLIN = VLIN + 3	
					ENDIF
				CASE LASTKEY() = 5
					IF VLIN > 4
						VLIN = VLIN - 3
					ENDIF
				CASE LASTKEY() = 4
					IF VCOL < 69
						VCOL = VCOL + 5
					ENDIF
				CASE LASTKEY() = 19
					IF VCOL > 39
						VCOL = VCOL - 5
					ENDIF
			ENDCASE
		ENDDO
		VDATA1=CTOD("01"+SUBSTR(DTOC(VDATA1),3,8))
ENDDO
SET COLOR TO &P_COR
SET CURSO ON
RESTORE SCREEN FROM VTELACALE
RETURN
PROCEDURE LETRA
	X_A = 8
	SWPRUNCMD("DEMO " +STR(X_A)+"",0,"","")
	@ 00,00 SAY SPACE(80)
	@ 00,00 SAY X_A
	IF X_A = 10
		X_A = 0
	ENDIF
	X_A = X_A + 1
***************
FUNCTION MENU_O
***************
PARAMETERS VCOL,VMENU,VINICIO,VCHR,VLOCAL
IF VLOCAL <> 0
	VOP = VLOCAL
ELSE
	VOP = 1
ENDIF
VCOL = VCOL + VLOCAL
DO WHILE .T.
	SAVE SCREEN TO VTELA_A
		@ VCOL,VINICIO SAY VCHR
		SET CURSO OFF
		INKEY(0)
		SET CURSO ON
	RESTORE SCREEN FROM VTELA_A
	IF LASTKEY() = 27 
		VOP = 0
		EXIT
	ENDIF
	IF LASTKEY() = 13
		EXIT
	ENDIF
	IF LASTKEY() = 5
		IF VOP > 1
			VOP = VOP -1
			VCOL = VCOL - 1
		ENDIF
	ENDIF
	IF LASTKEY() = 24
		IF VOP < VMENU
			VOP = VOP + 1
			VCOL = VCOL + 1
		ENDIF
	ENDIF
ENDDO
RETURN VOP

*******************
PROCEDURE VER_SENHA
*******************
USE USUARIO
GO TOP
VSENHA_Q = .F.
DO WHILE !EOF()
	VSENHAT = SENHA
	IF OPOSTO(VSENHAT) = "NSLTR"
		VSENHA_Q = .T.	
		EXIT
	ELSE
		VSENHA_Q = .F.
	ENDIF
	SKIP
ENDDO
IF VSENHA_Q = .F.
	APPEND BLANK
	REPLACE NOME WITH "Senha Mestra"
	REPLACE SENHA WITH CRIPTA("NSLTR")
ENDIF	
CLOSE ALL
CLEAR
SWPRUNCMD("MD B",0,"","")
CLEAR
? "AGUARDE CARREGANDO O PROGRAMA..."
	IF FILE("PRAZO.DBF")
		COPY FILE("PRAZO.DBF") TO B\PRAZO.DBF
	ENDIF
	IF FILE("CLIENTE.DBF")
		COPY FILE("CLIENTE.DBF") TO B\CLIENTE.DBF
	ENDIF
	IF FILE("PRODUTO.DBF")
		COPY FILE("PRODUTO.DBF") TO B\PRODUTO.DBF
	ENDIF
	IF FILE("TEMP.DBF")
		COPY FILE("TEMP.DBF") TO B\TEMP.DBF
	ENDIF
	IF FILE("VENDAS.DBF")
		COPY FILE("VENDAS.DBF") TO B\VENDAS.DBF
	ENDIF
	IF FILE("CONFIG.DBF")
		COPY FILE("CONFIG.DBF") TO B\CONFIG.DBF
	ENDIF
	IF FILE("USUARIO.DBF")
		COPY FILE("USUARIO.DBF") TO B\USUARIO.DBF
	ENDIF
	IF FILE("BROWSE.COM")
		COPY FILE("BROWSE.COM") TO B\BROWSE.COM
	ENDIF
	IF FILE("NEW.EXE")
		COPY FILE("NEW.EXE") TO B\NEW.EXE
	ENDIF
	IF FILE("ARJ.EXE")
		COPY FILE("ARJ.EXE") TO B\ARJ.EXE
	ENDIF
	SWPRUNCMD("VOL > TRAVA",0,"","")
	ARQTRAVA= FOPEN("TRAVA")
	PIRATA = FREADSTR(ARQTRAVA, 82)
	PIRATA = ALLTRIM(PIRATA)
	PIRATA = SUBSTR(PIRATA, -11, 09)
	FCLOSE(ARQTRAVA)
	SWPRUNCMD("DEL TRAVA",0,"","")
	USE CONFIG
	GO TOP
	VHD=HD
	IF VHD=SPACE(9)
		REPLACE HD WITH PIRATA
	ELSE
		IF VHD<>PIRATA
			SAVE SCREEN TO VA
			SET COLOR TO W+/B
			CLEAR
			SOBRA(00,00,23,79,"N/B","B+/B")
*			SET COLOR TO R*+/B
*			@ 00,00 SAY REPLICATE(" COPIA NAO AUTORIZANDA ",150)
			SAVE SCREEN TO VTEALP		
			SET COLOR TO GR+/W
			@ 09,11 SAY SPACE(59)
			@ 09,11 SAY"Erro ?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨"
			SET COLOR TO W/N
			@ 10,12 CLEAR TO 17,70
			SET COLOR TO GR+/R
			@ 10,11 CLEAR TO 16,69
			SET COLOR TO GR+*/R
			CENTRA(11,00,80,"Copia Nao Autorizada")
			SET COLOR TO GR+/R
			CENTRA(12,00,80,"Para Mairoes Infomacoes Ligue Para")
			CENTRA(13,00,80,"9946-6100 (c) Cleber de Almeida Sores")
			CENTRA(14,00,80,"Obrigando ! ! !")
		   @ 24,00 SAY SPACE(80)
			CENTRA(24,00,80,'"ESC" OU "ENTER" OU "F3"  =   SAIR')
			@ 16,12 SAY REPLICATE(CHR(7),57)
*  	    TONE(700, 2)
 *    	 TONE(900, 5)
			Y = 12
			p = 1
			A = 16
			SET CURSO OFF
			DO WHILE LASTKEY()#13 .AND. LASTKEY()#27 .AND. LASTKEY()#-2
				SAVE SCREEN TO VTELA
				@ 16,Y SAY CHR(A)
				INKEY(0.1)
				RESTORE SCREEN FROM VTELA
				IF P = 1 
					Y = Y + 1
					A=16
					iF Y = 69
						P = 2
					ENDIF
				ENDIF
				IF P = 2 
   				Y = Y - 1
					A =17
			      IF Y = 12 
				        P = 1
					ENDIF
				ENDIF
			ENDDO
			?  ""
			SET COLOR TO 
			RESTORE SCREEN FROM VA
			? ""
			? ""
			? ""
			? ""
			? ""
			? ""
			? ""
			? ""
		SET CURSO ON
		QUIT
	ENDIF
ENDIF

**************
PROCEDURE SHOW
**************
SAVE SCREEN TO VTELA_PESQCLITESTE
PRIVATE VCAMPOS[4],VCAB[4]
	SET KEY -2 TO 
	VKEY = ""
	KEYBOARD CHR(1)
	USE PRODUTO INDEX PRODUTO2 INDEX PRODUTO1
	VCAMPOS[1] = "DESCRICAO"
	VCAMPOS[2] = "CODP"
	VCAMPOS[3] = "VALOR"
*	VCAMPOS[4] = "RIGHT(STRZERO(CONT - QTD,5),LEN(VCAMPOS[4])-1)" 

	VCAB[1] = "Descricao"
	VCAB[2] = "Codigo" 
	VCAB[3] = "Valor"
*	VCAB[4] = "Qantidate A Compra"

	@ 04,10 CLEAR TO 16,75
	@ 04,10 TO 17,76 DOUBLE

	@ 06,11 TO 06,75 DOUBLE
	SET COLOR TO N/W
		@ 05,11 SAY SPACE(65)
		@ 05,11 SAY UPPER(VKEY)
	SET COLOR TO N*/W
		@ 05,11+LEN(VKEY) SAY "_"
	SET COLOR TO W+/RB,N/W
	DBEDIT(7,11,16,75,VCAMPOS,"BUSCA",0,VCAB)
RESTORE SCREEN FROM VTELA_PESQCLITESTE
RETURN

FUNCTION BUSCA						&& pula para letra

	PARAMETERS VMODO,VCAMPO
	PRIVATE VRET
	
	IF VMODO=4 &&AND. LASTKEY()>31 .AND. LASTKEY()<128 .OR. LASTKEY()=8 
		IF LASTKEY()>31 .AND. LASTKEY()<128 .OR. LASTKEY()=8 	
			TECLA = LASTKEY()
			IF TECLA = 8 .OR. TECLA = 19
				VKEY = LEFT(VKEY,LEN(VKEY)-1)
			ELSE
				VKEY = VKEY + CHR(TECLA)
			ENDIF
			SET SOFTSEEK ON
			SEEK UPPER(VKEY)
			SET SOFTSEEK OFF
			SET COLOR TO N/W
				@ 05,11 SAY SPACE(65)
				@ 05,11 SAY UPPER(VKEY)
			SET COLOR TO N*/W
				@ 05,11+LEN(VKEY) SAY "_"
			SET COLOR TO W+/RB,N/W
			VRET = 2
		ELSE
		IF  LASTKEY()=13 .OR. LASTKEY()=27
				VRET = 0
				VKEY = VCODP 
			ELSE
				VRET = 1
			ENDIF		
		ENDIF
	ELSE
	  IF  LASTKEY()=13 .OR. LASTKEY()=27
			VRET = 0
			VKEY = CODP
		ELSE
			VRET = 1
		ENDIF
		
	ENDIF
	IF LASTKEY() = 5 .OR. LASTKEY() = 24
		VKEY = ALLTRIM(DESCRICAO)
		SET COLOR TO N/W
			@ 05,11 SAY SPACE(65)
			@ 05,11 SAY UPPER(VKEY)
		SET COLOR TO N*/W
			@ 05,11+LEN(VKEY) SAY "_"
		SET COLOR TO W+/RB,N/W
	ENDIF
	IF LASTKEY() = 19
		VKEY = ""
		SET COLOR TO N/W
			@ 05,11 SAY SPACE(65)
			@ 05,11 SAY UPPER(VKEY)
		SET COLOR TO N*/W
			@ 05,11+LEN(VKEY) SAY "_"
		SET COLOR TO W+/RB,N/W
	ENDIF	
	CODIGOT = CODP

	RETURN VRET

**************	
PROCEDURE HIDE
**************
	VKEY = ""
	DO SHOW
	IF LASTKEY()#27
		VCODP = CODIGOT
		KEYBOARD CHR(13)
	ENDIF
******************
PROCEDURE SHOW_C
******************
SAVE SCREEN TO VTELA_1
PRIVATE VCAMPOS[4],VCAB[4]
	VKEY = ""
	KEYBOARD CHR(1)
	USE CLIENTE INDEX CLIENTE2 INDEX CLIENTE1
	VCAMPOS[1] = "NOME"
	VCAMPOS[2] = "PLACA"
	VCAMPOS[3] = "TEL" 

	VCAB[1] = "Nome"
	VCAB[2] = "Placa" 
	VCAB[3] = "Telefone"

	@ 04,10 CLEAR TO 16,75
	@ 04,10 TO 17,76 DOUBLE

	@ 06,11 TO 06,75 DOUBLE
	SET COLOR TO N/W
		@ 05,11 SAY SPACE(65)
		@ 05,11 SAY UPPER(VKEY)
	SET COLOR TO N*/W
		@ 05,11+LEN(VKEY) SAY "_"
	SET COLOR TO W+/RB,N/W
	DBEDIT(7,11,16,75,VCAMPOS,"BUSCA_C",0,VCAB)
RESTORE SCREEN FROM VTELA_1
RETURN
PROCEDURE E
	VKEY = ""
	DO SHOW_C
	IF LASTKEY()#27
		VPLACA = CODIGOT
		KEYBOARD CHR(13)
	ENDIF

FUNCTION BUSCA_C						&& pula para letra

	PARAMETERS VMODO,VCAMPO
	PRIVATE VRET
	
	IF VMODO=4 &&AND. LASTKEY()>31 .AND. LASTKEY()<128 .OR. LASTKEY()=8 
		IF LASTKEY()>31 .AND. LASTKEY()<128 .OR. LASTKEY()=8 	
			TECLA = LASTKEY()
			IF TECLA = 8 .OR. TECLA = 19
				VKEY = LEFT(VKEY,LEN(VKEY)-1)
			ELSE
				VKEY = VKEY + CHR(TECLA)
			ENDIF
			SET SOFTSEEK ON
			SEEK UPPER(VKEY)
			SET SOFTSEEK OFF
			SET COLOR TO N/W
				@ 05,11 SAY SPACE(65)
				@ 05,11 SAY UPPER(VKEY)
			SET COLOR TO N*/W
				@ 05,11+LEN(VKEY) SAY "_"
			SET COLOR TO W+/RB,N/W
			VRET = 2
		ELSE
		IF  LASTKEY()=13 .OR. LASTKEY()=27
				VRET = 0
				VKEY = PLACA 
			ELSE
				VRET = 1
			ENDIF		
		ENDIF
	ELSE
	  IF  LASTKEY()=13 .OR. LASTKEY()=27
			VRET = 0
			VKEY = PLACA
		ELSE
			VRET = 1
		ENDIF
		
	ENDIF
	IF LASTKEY() = 5 .OR. LASTKEY() = 24
		VKEY = ALLTRIM(NOME)
		SET COLOR TO N/W
			@ 05,11 SAY SPACE(65)
			@ 05,11 SAY UPPER(VKEY)
		SET COLOR TO N*/W
			@ 05,11+LEN(VKEY) SAY "_"
		SET COLOR TO W+/RB,N/W
	ENDIF
	IF LASTKEY() = 19
		VKEY = ""
		SET COLOR TO N/W
			@ 05,11 SAY SPACE(65)
			@ 05,11 SAY UPPER(VKEY)
		SET COLOR TO N*/W
			@ 05,11+LEN(VKEY) SAY "_"
		SET COLOR TO W+/RB,N/W
	ENDIF
	CODIGOT = PLACA

	RETURN VRET
***************
* CALCULADORA *
***************
FUNCTION CALC
VCORES = SETCOLOR()
SAVE SCREEN TO VTELA_CALC
	@ 08,50 CLEAR TO 18,63
	@ 08,50 TO 18,63 DOUBLE
	SET COLOR TO N/W
	@ 09,51 SAY SPACE(12)
	SET COLOR TO W/N
	@ 11,52 SAY "1"
	@ 11,55 SAY "2"
	@ 11,58 SAY "3"
	@ 13,52 SAY "4"
	@ 13,55 SAY "5"
	@ 13,58 SAY "6"
	@ 15,52 SAY "7"
	@ 15,55 SAY "8"
	@ 15,58 SAY "9"
	@ 11,61 SAY "ö"
	@ 13,61 SAY "X"
	@ 15,61 SAY "+"
	@ 17,61 SAY "-"
	@ 17,55 SAY "0"
	INKEY(0)
************
FUNCTION PAS
************
PARAMETERS VLIN,VCOL,VSPACE
SAVE SCREEN TO VTELA_PAS
*PUBLIC VSENHA
VSENHA = ""
VCORES = SETCOLOR()
DO WHILE .T.
	SET COLOR TO I/W
	@ VLIN,VCOL SAY SPACE(VSPACE)
	@ VLIN,VCOL SAY REPLICATE(CHR(4),LEN(VSENHA))
*	@ VLIN,VCOL+LEN(VSENHA) SAY ""
	SET COLOR TO &VCORES
	A = INKEY(0)
	IF LASTKEY()>31 .AND. LASTKEY()<128
		IF LEN(VSENHA)<VSPACE
			VSENHA = VSENHA + CHR(A)
		ENDIF
	ENDIF
	IF LASTKEY() = 8 .OR. LASTKEY()=19
		VSENHA = LEFT(VSENHA,LEN(VSENHA)-1)
	ENDIF
	IF LASTKEY()=27 .OR. LASTKEY()=13
		EXIT 
	ENDIF
ENDDO
RESTORE SCREEN FROM VTELA_PAS
RETURN VSENHA
FUNCTION MENU
PARAMETERS VCOL,VMENU,VINICIO,VFIM,VTRUE,VFALSE,VTIPO
VOP = 1
DO WHILE .T.
	SAVE SCREEN TO VTELA_A
		IF VTRUE = .T.
			@ VCOL,VINICIO SAY CHR(16)
		ENDIF
		IF VFALSE = .T.
			@ VCOL,VFIM SAY CHR(17)
		ENDIF
		SET CURSO OFF
		INKEY(0)
		SET CURSO ON
	RESTORE SCREEN FROM VTELA_A
	IF LASTKEY() = 27 
		VOP = 0
		EXIT
	ENDIF
	IF LASTKEY() = 13
		EXIT
	ENDIF
	IF LASTKEY() = 5
		IF VOP > 1
			VOP = VOP -1
			VCOL = VCOL - 1
		ENDIF
	ENDIF
	IF LASTKEY() = 24
		IF VOP < VMENU
			VOP = VOP + 1
			VCOL = VCOL + 1
		ENDIF
	ENDIF
ENDDO
RETURN VOP

FUNCTION Cleber_Up
PARAMETERS File, Drive ,VD
USE &FILE
DO WHILE .T.
   nSpaceNeeded = INT((RECSIZE() * LASTREC()) + HEADER() + 1)
   nTargetDrive = ASC(UPPER(Drive)) - 64
	VRET = .T.
   IF DISKSPACE(VD) < nSpaceNeeded
		MSGBOX("Disco Cheio, Insira Outro!") 
		IF LASTKEY() = 27
			EXIT
		ENDIF
		LOOP
		VRET = .F.
	ELSE 
		CLOSE ALL
		VRET = .T.
	   COPY FILE(File) TO (Drive + ":\" + File)
   ENDIF
	EXIT
ENDDO
CLOSE ALL
RETURN VRET 

PROCEDURE C_COPIA
SAVE SCREEN TO VTELA_A_A_A_A_A_A_A
	VCOLOR = SETCOLOR()
	CLOSE ALL
	SET COLOR TO 
	CLEAR
	ERASE("A:\New_Set.exe")
	SWPRUNCMD("ARJ A -JE -X -G:NSLTR A:\New_Set *.PRG *.DBF NEW.EXE BROWSE.COM /Y",0,"","")				
	SET COLOR TO &VCOLOR
RESTORE SCREEN FROM VTELA_A_A_A_A_A_A_A
RETURN