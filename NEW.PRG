******************************************************************************
*    PROGRAMA DE GERENCIAMENTO DE OFICINA FEITO POR CLEBER DE ALMEIDA SOARES  *
*  PARA MOTO SOCORRO LORINHO LTDA. NEW.PRG FONT PRINCIPAL DO PROGRAMA CONTEDO *
*				 OS MENU DE ACESSO E AS CONFIRGURAÄÂES DO SISTEMA                *
******************************************************************************
PUBLIC PCOLOR,VOPCAOXYV,VSIM,VSHOW,VKEY,VCODP,CODIGOT,V_TELA
SWPRUNCMD("MODE CO40",0,"","")
DO NEW000
DO NEW001
DO NEW002
DO VER_SENHA
SET KEY -20 TO C_COPIA
X_A = 7
SWPRUNCMD("MODE CO80",0,"","")
SWPRUNCMD("DEMO " +STR(X_A)+"",0,"","")
SAVE SCREEN TO VTELA_P
	IF !FILE("CLIENTE1.NTX")
		BOX("INDEXANDO OS ARQUIVO DE CLIENTE") 
		USE CLIENTE
		INDEX ON PLACA TO CLIENTE1
		INDEX ON NOME TO CLIENTE2
		INDEX ON EMP TO CLIENTE3
	ENDIF
	IF !FILE("PRODUTO1.NTX")
		BOX("INDEXANDO OS ARQUIOS DE PRODUTOS")
		USE PRODUTO
		INDEX ON CODP TO PRODUTO1
		INDEX ON DESCRICAO TO PRODUTO2
	ENDIF
RESTORE SCREEN FROM VTELA_P
USE CONFIG 
VNOME_CLEBER = NOME
V_TELA = ALLTRIM(C)
X = 1
XY = 0
SWPRUNCMD("DEMO 4",0,"","")
DO WHILE .T.
	VB = SETCOLOR()
	SET COLOR TO N/BG
	IF V_TELA = "1"
		@ 00,00 SAY REPLICATE("±±±",680)
	ELSEIF V_TELA = "2"
		@ 00,00 SAY REPLICATE("¬ƒ¡",680)
	ELSEIF V_TELA = "3"
		@ 00,00 SAY REPLICATE(" ÀÕ",680)
	ELSEIF V_TELA = "4"
		@ 00,00 SAY REPLICATE("±±±",680)
	ELSEIF V_TELA = "5"
	  	@ 00,00 SAY REPLICATE("≤≤≤",680)
	ELSEIF V_TELA = "6"
		@ 00,00 SAY REPLICATE("∞∞∞",680)
	ELSEIF V_TELA = "7"
		@ 00,00 SAY REPLICATE(" "+ALLTRIM(VNOME_CLEBER)+" ",1872/LEN(ALLTRIM(VNOME_CLEBER)))
	ENDIF
	SET COLOR TO 
	@ 00,00 SAY SPACE(80)
	@ 24,00 SAY SPACE(80)
	@ 24,00 SAY DTOC(DATE())+" - "+DIASEM(DATE())+" - "+VNOME_CLEBER
	@ 24,63 SAY "Lazaro Vers∆o 1.0"
	SET COLOR TO W+/RB,N/W
	@ 00,00 SAY SPACE(80)
	@ 23,00 SAY SPACE(80)
	@ 00,00 SAY "  VENDAS  "
	@ 00,12 SAY " CADASTRO "
	@ 00,24 SAY "CONFIGURAR"
	@ 00,36 SAY "RELATORIOS"
	@ 00,48 SAY "  APOIO   "
	SET COLOR TO &VB
*	@ 09,25 CLEAR TO 12,50
*	@ 09,25  TO 12,50 DOUBLE
	@ 24,00 SAY SPACE(80)
	@ 24,00 SAY "Senha de Acesso: "
	IF XY = 3
		VOK = .F.
		EXIT 
	ENDIF
	VSENHA = PAS(24,17,63)	
	IF LASTKEY() = 27 
		SET COLOR TO 
		SWPRUNCMD("MODE CO80",0,"","")	
		CANCEL
	ENDIF
	USE USUARIO 
	GO TOP
*	VSENHA = CRIPTA(VSENHA)
	VOK = .F.
	DO WHILE !EOF()
		VT = OPOSTO(ALLTRIM(SENHA))
		IF VSENHA = VT
			VOK = .T.
			VNOME = NOME
			EXIT
		ELSE
			VOK = .F.
		ENDIF
		SKIP
		IF VOK = .T.
			EXIT
		ENDIF
	ENDDO
	IF VOK = .F.
		SAVE SCREEN TO V
			MSGBOX("Senha n∆o autorizanda!")
		RESTORE SCREEN FROM V
	ENDIF
	IF VOK = .T.
		EXIT 
	ENDIF
	X = X + 1
	XY = XY + 1
ENDDO

IF VOK = .F.
	MSGBOX("Operaá∆o cancelada!")
	SET COLOR TO
	SWPRUNCMD("MODE CO80",0,"","")	
	CANCEL
ENDIF

KEYBOARD CHR(31)
DO NEWW
*SET KEY 28 TO HELP
SET KEY 28 TO
SET KEY 390 TO ASPR999
SET KEY -2 TO HORA
SET KEY -3 TO A_CAL

SAVE SCREEN TO VTELA_PRINCIPAL


   USE CONFIG
	VNOME_CLEBER = UPPER(NOME)
	SET CONFIRM ON
	SET SCORE OFF
	SET CENTURY ON
	SET DATE BRITISH
	SET DELETED ON
	SET DEVICE TO SCREEN
	SET ESCAPE ON
	SET WRAP ON
	SET MESSAGE TO 23 CENTER
	SET COLOR TO GR+/BG
	CLEAR
*	@ 00,00 SAY REPLICATE("¬ƒ¡",680)
	SET COLOR TO W/N
	@ 24,00 SAY SPACE(80)
	@ 24,00 SAY DTOC(DATE())+" - "+DIASEM(DATE())+" - "+VNOME_CLEBER
	@ 24,63 SAY "Lazaro Vers∆o 1.0"
	SET COLOR TO W+/RB,N/W
	@ 00,00 SAY SPACE(80)
	@ 23,00 SAY SPACE(80)
	DO WHILE .T.
   	USE CONFIG
		VNOME_CLEBER = UPPER(NOME)
		VSIM = .T.
		SET COLOR TO N/BG
		CLEAR
		IF V_TELA = "1"
			@ 00,00 SAY REPLICATE("±±±",680)
		ELSEIF V_TELA = "2"
			@ 00,00 SAY REPLICATE("¬ƒ¡",680)
		ELSEIF V_TELA = "3"
			@ 00,00 SAY REPLICATE(" ÀÕ",680)
		ELSEIF V_TELA = "4"
			@ 00,00 SAY REPLICATE("±±±",680)
		ELSEIF V_TELA = "5"
		  	@ 00,00 SAY REPLICATE("≤≤≤",680)
		ELSEIF V_TELA = "6"
			@ 00,00 SAY REPLICATE("∞∞∞",680)
		ELSEIF V_TELA = "7"
			@ 00,00 SAY REPLICATE(" "+ALLTRIM(VNOME_CLEBER)+" ",1872/LEN(ALLTRIM(VNOME_CLEBER)))
		ENDIF
		SET COLOR TO W/N
		@ 22,00 SAY SPACE(80)
		CENTRA(22,00,80,"F3 HORA   F4 - CALENDARIO   F12 SAIR")
		@ 24,00 SAY SPACE(80)
		@ 24,00 SAY DTOC(DATE())+" - "+DIASEM(DATE())+" - "+VNOME_CLEBER
		@ 24,63 SAY "Lazaro Vers∆o 1.0"
		SET COLOR TO W+/RB,N/W
		@ 00,00 SAY SPACE(80)
		@ 23,00 SAY SPACE(80)
		@ 00,00 PROMPT "  VENDAS  " MESSAGE "Vendas,Re-Imprimir,Caixa"
		@ 00,12 PROMPT " CADASTRO " MESSAGE "Atualizaáao dos cadastros: Clientes, Produto"
		@ 00,24 PROMPT "CONFIGURAR" MESSAGE "Configura Firma"
		@ 00,36 PROMPT "RELATORIOS" MESSAGE "Relatorios Impressos"
		@ 00,48 PROMPT "  APOIO   " MESSAGE "Indexaáao de Arquivos, Backup e Restore"
		IF LASTKEY() = 4
			IF VOPCAOXY = 5
				VOPCAOXY = 1
			ELSE
				VOPCAOXY = VOPCAOXY + 1
			ENDIF
			KEYBOARD CHR(13)
		ENDIF
		IF LASTKEY() = 19
			IF VOPCAOXY = 1
				VOPCAOXY = 5
			ELSE
				VOPCAOXY = VOPCAOXY - 1
			ENDIF
			KEYBOARD CHR(13)
		ENDIF
		MENU TO VOPCAOXY

		DO CASE
			CASE VOPCAOXY = 1
				DO NEW1				
			CASE VOPCAOXY = 2
				DO NEW2
			CASE VOPCAOXY = 3
				DO NEW3
			CASE VOPCAOXY = 4
				DO NEW4
			CASE VOPCAOXY = 5
				DO NEW5
	ENDCASE
ENDDO
RESTORE SCREEN FROM VTELA_PRINCIPAL
RETURN
